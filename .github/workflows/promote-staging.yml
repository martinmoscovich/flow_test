name: Promote to Staging

on: 
  workflow_dispatch:
    inputs:
      release-version:
        description: 'Release version tag'
        required: true

env:
  DIST_DIR: build
  DEPLOYMENT_PATH: staging

jobs:
  # build:
  #   name: Build
  #   runs-on: ubuntu-latest

  #   steps:
  #     - name: Build
  #       uses: martinmoscovich/gh-actions/npm-build@1
  #       with:
  #         node_version: 14
  #         dist_dir: ${{ env.DIST_DIR }}

  promote:
    name: Promote to Staging
    # needs: build
    # if: startsWith(github.ref, 'refs/tags/v')
    runs-on: ubuntu-latest
    uses: martinmoscovich/gh-actions/.github/workflows/promote.yml@main
    with:
      to: staging
      tag: ${{ github.event.inputs.release-version }}
      release_filename: '${{ github.event.repository.name }}-${{ github.event.inputs.release-version }}.zip'
    secrets:
      github_token: ${{ secrets.GITHUB_TOKEN }}
